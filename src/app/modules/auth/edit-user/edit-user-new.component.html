<div class="modern-edit-user-container">
  <div class="form-header">
    <div class="header-icon">
      <mat-icon>person_edit</mat-icon>
    </div>
    <div class="header-text">
      <h1 class="dialog-title">Editar Usuario</h1>
      <p class="dialog-subtitle">Actualizar información del usuario</p>
    </div>
  </div>

  <div class="dialog-body">
    <form autocomplete="off" [formGroup]="formEditUser" (ngSubmit)="updateUser()">
      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Nombre</mat-label>
          <input matInput formControlName="firstName">
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Apellidos</mat-label>
          <input matInput formControlName="lastName">
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Email</mat-label>
          <input matInput formControlName="email">
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Contraseña</mat-label>
          <input matInput type="password" formControlName="password" placeholder="Dejar vacío para mantener actual">
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Rol</mat-label>
          <mat-select formControlName="role">
            <mat-option *ngFor="let role of roles" [value]="role">
              <div class="role-option">
                <mat-icon>{{role === 'ADMIN' ? 'admin_panel_settings' : role === 'BOSS' ? 'supervisor_account' : role === 'AGENT' ? 'support_agent' : role === 'USER' ? 'person' : 'group'}}</mat-icon>
                <span>{{ getRole(role) }}</span>
              </div>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Departamento</mat-label>
          <mat-select formControlName="departments">
            <mat-option *ngFor="let department of departments" [value]="department._id">
              {{ department.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Jefe</mat-label>
          <mat-select formControlName="boss">
            <mat-option [value]="">Sin jefe asignado</mat-option>
            <mat-option *ngFor="let user of bossUsers" [value]="user._id">
              {{ user.firstName }} {{ user.lastName }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field file-field">
          <mat-label>Avatar</mat-label>
          <input type="file" (change)="onFileSelected($event)" accept="image/*" style="display: none;" #fileInput>
          <input matInput [value]="avatarName || 'Ningún archivo seleccionado'" readonly (click)="fileInput.click()">
          <button matSuffix mat-icon-button type="button" (click)="fileInput.click()">
            <mat-icon>upload</mat-icon>
          </button>
        </mat-form-field>
      </div>

      <div class="form-row checkbox-row">
        <mat-checkbox formControlName="reporter" class="custom-checkbox">
          <span class="checkbox-label">
            <mat-icon>assignment_ind</mat-icon>
            Reporter
          </span>
        </mat-checkbox>
      </div>
    </form>
  </div>

  <div class="dialog-actions">
    <button type="button" class="cancel-btn" (click)="closedDialog()">
      <mat-icon>close</mat-icon>
      Cancelar
    </button>
    <button type="button" class="save-btn" (click)="updateUser()">
      <mat-icon>save</mat-icon>
      Guardar Cambios
    </button>
  </div>
</div>
