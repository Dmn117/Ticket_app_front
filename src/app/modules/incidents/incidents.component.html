<div class="incidents-container">
  <mat-card class="incidents-card">
    <mat-card-content>
      <!-- Header Section -->
      <div class="page-header">
        <div class="header-content">
          <mat-icon class="header-icon">report_problem</mat-icon>
          <div class="header-text">
            <h1 class="page-title">Incidencias</h1>
            <p class="page-subtitle">Gestión de incidencias del sistema</p>
          </div>
        </div>
        <div class="header-actions">
          <button mat-raised-button class="primary-button" (click)="createIncidence()">
            <mat-icon>add</mat-icon>
            Agregar Incidencia
          </button>
        </div>
      </div>

      <!-- Table Section -->
      <div class="table-container">
        <app-material-table [dataSourceMat]="dataSourceMat" [displayedColumns]="displayedColumns">
          <table mat-table [dataSource]="dataSourceMat" class="modern-table" matSort>

    <!-- Columna: Título -->
    <ng-container matColumnDef="title">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Título </th>
      <td mat-cell *matCellDef="let incident"> {{ incident.title }} </td>
    </ng-container>

    <!-- Columna: Descripción -->
    <ng-container matColumnDef="description">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Descripción </th>
      <td mat-cell *matCellDef="let incident"> {{ incident.description }} </td>
    </ng-container>

    <!-- Columna: Severidad -->
    <!-- <ng-container matColumnDef="severity">
      <th mat-header-cell *matHeaderCellDef> Severidad </th>
      <td mat-cell *matCellDef="let incident"> {{ incident.severity }} </td>
    </ng-container> -->

    <!-- Columna: Autor -->
    <!-- <ng-container matColumnDef="author">
      <th mat-header-cell *matHeaderCellDef> Autor </th>
      <td mat-cell *matCellDef="let incident"> {{ incident.author.firstName }} {{ incident.author.lastName}} </td>
    </ng-container> -->

    <!-- Columna: agente -->
    <ng-container matColumnDef="agent">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Dirigido a </th>
      <td mat-cell *matCellDef="let incident"> {{ incident.agent.firstName }} {{ incident.agent.lastName}} </td>
    </ng-container>

    <!-- Columna: Fecha de creación -->
    <ng-container matColumnDef="createdAt">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Fecha de Creación </th>
      <td mat-cell *matCellDef="let incident"> {{ incident.createdAt | date:'short' }} </td>
    </ng-container>

            <!-- Columna: Acciones -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef> Acciones </th>
              <td mat-cell *matCellDef="let incident">
                <button mat-icon-button class="action-button view-button" (click)="viewIncident(incident)" 
                        matTooltip="Ver incidencia">
                  <mat-icon>visibility</mat-icon>
                </button>
              </td>
            </ng-container>

            <!-- Filas de encabezado y datos -->
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </app-material-table>
      </div>
    </mat-card-content>
  </mat-card>
</div>
